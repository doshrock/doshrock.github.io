<!-- Disqus -->
<!--script id="dsq-count-scr" src="//doshrock.disqus.com/count.js" async></script-->
<!-- jQuery -->
<script src="js/jquery.js"></script>

<!-- Bootstrap 5.3.3 JavaScript Bundle (includes Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

<!-- Plugin JavaScript -->
<script src="js/jquery.easing.min.js"></script>
<script src="js/jquery.fittext.js"></script>
<script src="js/wow.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="js/creative.js"></script>

<!-- Menu Image Modal Script -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    var modal = document.getElementById('menuImageModal');
    var modalImg = document.getElementById('menuModalImage');
    var closeBtn = document.getElementsByClassName('menu-modal-close')[0];
    var imageLinks = document.getElementsByClassName('menu-image-link');

    // Add click event to all menu image links
    for (var i = 0; i < imageLinks.length; i++) {
        imageLinks[i].addEventListener('click', function(e) {
            e.preventDefault();
            var imageSrc = this.getAttribute('data-image');
            modal.style.display = 'block';
            modalImg.src = imageSrc;
        });
    }

    // Close modal when clicking the X button
    closeBtn.addEventListener('click', function() {
        modal.style.display = 'none';
    });

    // Close modal when clicking outside the image
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            modal.style.display = 'none';
        }
    });

    // Close modal when pressing Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && modal.style.display === 'block') {
            modal.style.display = 'none';
        }
    });
});

// Enhanced scrollspy with manual active state management
$(document).ready(function() {
    // Refresh scrollspy after page loads
    $('[data-spy="scroll"]').each(function () {
        $(this).scrollspy('refresh');
    });

    // Manual scroll tracking for better accuracy
    function updateActiveNav() {
        var scrollPos = $(document).scrollTop() + 150;

        $('#mainNav .nav-link').each(function() {
            var currLink = $(this);
            var refElement = $(currLink.attr('href'));

            if (refElement.length > 0 && refElement.position().top <= scrollPos &&
                refElement.position().top + refElement.height() > scrollPos) {
                $('#mainNav .nav-item').removeClass('active');
                currLink.parent().addClass('active');
            } else {
                currLink.parent().removeClass('active');
            }
        });
    }

    $(window).on('scroll', updateActiveNav);
    updateActiveNav(); // Initial call

    // Handle nav link clicks
    $('#mainNav .nav-link.page-scroll').on('click', function() {
        $('#mainNav .nav-item').removeClass('active');
        $(this).parent().addClass('active');
    });
});
</script>
