<!-- Disqus -->
<!--script id="dsq-count-scr" src="//doshrock.disqus.com/count.js" async></script-->
<!-- jQuery -->
<script src="js/jquery.js"></script>

<!-- Bootstrap 5.3.3 JavaScript Bundle (includes Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

<!-- Plugin JavaScript -->
<script src="js/jquery.easing.min.js"></script>
<script src="js/jquery.fittext.js"></script>
<script src="js/wow.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="js/creative.js"></script>

<!-- Menu Image Modal Script -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    var modal = document.getElementById('menuImageModal');
    var modalImg = document.getElementById('menuModalImage');
    var closeBtn = document.getElementsByClassName('menu-modal-close')[0];
    var imageLinks = document.getElementsByClassName('menu-image-link');

    // Add click event to all menu image links
    for (var i = 0; i < imageLinks.length; i++) {
        imageLinks[i].addEventListener('click', function(e) {
            e.preventDefault();
            var imageSrc = this.getAttribute('data-image');
            modal.style.display = 'block';
            modalImg.src = imageSrc;
        });
    }

    // Close modal when clicking the X button
    closeBtn.addEventListener('click', function() {
        modal.style.display = 'none';
    });

    // Close modal when clicking outside the image
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            modal.style.display = 'none';
        }
    });

    // Close modal when pressing Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && modal.style.display === 'block') {
            modal.style.display = 'none';
        }
    });
});

// Enhanced scrollspy with manual active state management
$(document).ready(function() {
    // Manual scroll tracking for accurate highlighting
    function updateActiveNav() {
        var scrollPos = $(window).scrollTop() + 150;
        var found = false;

        // Check each section
        $('#mainNav .nav-link.page-scroll').each(function() {
            var currLink = $(this);
            var href = currLink.attr('href');

            // Skip external links
            if (!href || href.indexOf('http') === 0) {
                return;
            }

            try {
                var refElement = $(href);
                if (refElement.length === 0) {
                    return;
                }

                var sectionTop = refElement.offset().top;
                var sectionBottom = sectionTop + refElement.outerHeight();

                if (sectionTop <= scrollPos && sectionBottom > scrollPos && !found) {
                    $('#mainNav .nav-item').removeClass('active');
                    currLink.parent().addClass('active');
                    console.log('Active section:', href);
                    found = true;
                }
            } catch(e) {
                console.error('Error processing link:', href, e);
            }
        });

        // If no section found, remove all active states
        if (!found && scrollPos > 200) {
            // Keep last section active if we're at the bottom
            if ($(window).scrollTop() + $(window).height() >= $(document).height() - 100) {
                $('#mainNav .nav-item').removeClass('active');
                $('#mainNav .nav-link.page-scroll:last').parent().addClass('active');
            }
        }
    }

    // Update on scroll
    $(window).on('scroll', updateActiveNav);

    // Initial call
    setTimeout(updateActiveNav, 100);

    // Handle nav link clicks
    $('#mainNav .nav-link.page-scroll').on('click', function() {
        var href = $(this).attr('href');
        if (href && href.indexOf('#') === 0) {
            $('#mainNav .nav-item').removeClass('active');
            $(this).parent().addClass('active');
        }
    });
});

// Highlight current day in opening hours
$(document).ready(function() {
    // Get current day of week (0 = Sunday, 1 = Monday, etc.) based on browser timezone
    var currentDay = new Date().getDay();

    // Find and highlight the row with matching data-day attribute
    $('.opening-hours-table tr[data-day="' + currentDay + '"]').addClass('current-day');

    console.log('Current day of week:', currentDay);
});
</script>
